{% extends 'base.html' %}
{% block title %}Event Details{% endblock %}

{% block body %}
<div class="event-details">
  <h2>Event Details</h2>
  <ul>
    <li>Event name: {{ display_event.title}} </li>
    <li>Event date: {{ display_event.event_at.date() }} </li>
    <li>Event time: {{ display_event.event_at.time() }} </li>
  </ul>
  <strong>Participants and RSVP status</strong>
  <ol>{% for participant in display_event.participants %}
    <li>Participant email: {{ participant.email }}
        {% if participant.is_host == True %}
          (host)
          <br>RSVP status: Attending
        {% else %}
          <br>RSVP status:
          {% if participant.RSVP == False %}
          <div class="rsvp-status" style.display="">Not attending</div>
          {% elif participant.RSVP == True %}
          <div class="rsvp-status" style.display="">Attending</div>
          {% elif participant.RSVP == None %}
          <div class="rsvp-status" style.display="">Awaiting response</div>
          {% endif %}
          <div class="btn-rsvp" style.display="none"></div>
          {% if participant.email == session.get('invitee_user_email') %}
          <br>Please RSVP: <button type="button" class="btn-rsvp-yes" value="{{ display_event.event_id }}">YES</button>
                           <button type="button" class="btn-rsvp-no" value="{{ display_event.event_id }}">NO</button>
          {% elif participant.email == session.get('current_user_email') %}
          <br>Please RSVP: <button type="button" class="btn-rsvp-yes" value={{ display_event.event_id }}>YES</button>
                           <button type="button" class="btn-rsvp-no" value="{{ display_event.event_id }}">NO</button>
          {% endif %}
        {% endif %}
    </li><br>
    {% endfor %}
  </ol>
</div>

<div class="movie-details">
  <h2>Movie Details</h2>
    {% for movie in movies_data %}
    <img src="https://image.tmdb.org/t/p/original{{ movie['poster'] }}" alt="poster" width="100"/><br>
    <form class="movie-votes">
      <input type="hidden" name="vote-id" value="{{ movie['id'] }}">
      <button type="button" class="vote-me" id="vote-{{ movie['id'] }}">Vote Me!</button>
    </form>
    <p>CURRENT NUMBER OF VOTES: {{ movie['vote'] }}</p>
    <p>Movie title: {{ movie['title'] }}</p>
    <details id=${movie.id}>
      <summary>More details:</summary>
      <p>Genres: {{ movie['genres'] }}</p>
      <p>Runtime: {{ movie['runtime'] }}</p>
      <p>Popularity: {{ movie['popularity'] }}</p>
      <p>Release date: {{ movie['release_date'] }}</p>
      <p>Overview: {{ movie['overview'] }}</p>
    </details>
    <br><br>
    {% endfor %}
</div>
{% endblock %}